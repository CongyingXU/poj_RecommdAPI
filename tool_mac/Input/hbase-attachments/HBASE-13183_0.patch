From 09aff0afd78202b42ab5e67f45eca8b23f7b973e Mon Sep 17 00:00:00 2001
From: Andrew Purtell <apurtell@apache.org>
Date: Mon, 9 Mar 2015 16:03:34 -0700
Subject: [PATCH] HBASE-13183 Make ZK tickTime configurable in standalone HBase
 (Alex Araujo)

---
 hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java   | 4 ++++
 .../main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java | 5 +++++
 2 files changed, 9 insertions(+)

diff --git a/hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java b/hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java
index 5c75ca8..19e251a 100644
--- a/hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java
+++ b/hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java
@@ -206,6 +206,10 @@ public final class HConstants {
   public static final String ZOOKEEPER_DATA_DIR =
       ZK_CFG_PROPERTY_PREFIX + "dataDir";
 
+  /** Parameter name for the ZK tick time */
+  public static final String ZOOKEEPER_TICK_TIME =
+      ZK_CFG_PROPERTY_PREFIX + "tickTime";
+
   /** Default limit on concurrent client-side zookeeper connections */
   public static final int DEFAULT_ZOOKEPER_MAX_CLIENT_CNXNS = 300;
 
diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java
index 2a3ef08..6ac681e 100644
--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java
+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java
@@ -191,6 +191,11 @@ public class HMasterCommandLine extends ServerCommandLine {
           }
         }
         zooKeeperCluster.setDefaultClientPort(zkClientPort);
+        // set the ZK tick time if specified
+        int zkTickTime = conf.getInt(HConstants.ZOOKEEPER_TICK_TIME, 0);
+        if (zkTickTime > 0) {
+          zooKeeperCluster.setTickTime(zkTickTime);
+        }
 
         // login the zookeeper server principal (if using security)
         ZKUtil.loginServer(conf, "hbase.zookeeper.server.keytab.file",
-- 
2.2.2

