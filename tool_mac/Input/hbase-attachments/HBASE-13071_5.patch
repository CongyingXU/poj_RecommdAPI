From 0e84243e8ad82eb3bbb202b7f467223160e89b72 Mon Sep 17 00:00:00 2001
From: eshcar <eshcar@yahoo-inc.com>
Date: Sun, 10 May 2015 11:11:44 +0300
Subject: [PATCH] HBASE-13071 rebase 2: size-in-bytes basis for scans

---
 .../hbase/client/ClientAsyncPrefetchScanner.java   |  234 ++++++++++++++++++++
 .../apache/hadoop/hbase/client/ClientScanner.java  |   59 +++--
 .../hadoop/hbase/client/ClientSimpleScanner.java   |   54 +++++
 .../hadoop/hbase/client/ClientSmallScanner.java    |   13 +-
 .../org/apache/hadoop/hbase/client/HTable.java     |   17 +-
 .../hadoop/hbase/client/ReversedClientScanner.java |    2 +-
 .../java/org/apache/hadoop/hbase/client/Scan.java  |   30 ++-
 .../hadoop/hbase/client/TableConfiguration.java    |   14 +-
 .../hadoop/hbase/client/TestClientScanner.java     |   10 +
 .../client/TestClientSmallReversedScanner.java     |   32 ++-
 .../hbase/client/TestClientSmallScanner.java       |   34 ++-
 .../hbase/client/TestScannersFromClientSide.java   |   49 ++++
 12 files changed, 481 insertions(+), 67 deletions(-)
 create mode 100644 hbase-client/src/main/java/org/apache/hadoop/hbase/client/ClientAsyncPrefetchScanner.java
 create mode 100644 hbase-client/src/main/java/org/apache/hadoop/hbase/client/ClientSimpleScanner.java

diff --git a/hbase-client/src/main/java/org/apache/hadoop/hbase/client/ClientAsyncPrefetchScanner.java b/hbase-client/src/main/java/org/apache/hadoop/hbase/client/ClientAsyncPrefetchScanner.java
new file mode 100644
index 0000000..c4eb478
--- /dev/null
+++ b/hbase-client/src/main/java/org/apache/hadoop/hbase/client/ClientAsyncPrefetchScanner.java
@@ -0,0 +1,234 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.hadoop.hbase.client;
+
+import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.hbase.TableName;
+import org.apache.hadoop.hbase.classification.InterfaceAudience;
+import org.apache.hadoop.hbase.ipc.RpcControllerFactory;
+import org.apache.hadoop.hbase.util.Threads;
+
+import java.io.IOException;
+import java.util.Queue;
+import java.util.concurrent.ConcurrentLinkedQueue;
+import java.util.concurrent.ExecutorService;
+import java.util.concurrent.LinkedBlockingQueue;
+import java.util.concurrent.atomic.AtomicBo