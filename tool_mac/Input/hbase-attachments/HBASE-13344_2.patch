From cb6282ff6a01818da33a00075c886cedd7d7bf8a Mon Sep 17 00:00:00 2001
From: Matt Warhaftig <mwarhaftig@gmail.com>
Date: Sun, 12 Apr 2015 15:52:24 -0400
Subject: [PATCH] HBASE-13344 - Add max Java version check for pom
 dependencies.

---
 pom.xml | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)

diff --git a/pom.xml b/pom.xml
index ce49c04..0dec34f 100644
--- a/pom.xml
+++ b/pom.xml
@@ -806,6 +806,13 @@
       <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-enforcer-plugin</artifactId>
+        <dependencies>
+          <dependency>
+            <groupId>org.codehaus.mojo</groupId>
+            <artifactId>extra-enforcer-rules</artifactId>
+            <version>${extra.enforcer.version}</version>
+          </dependency>
+        </dependencies>
         <!-- version set by parent -->
         <configuration>
           <rules>
@@ -829,6 +836,14 @@
   See the reference guide on building for more information: http://hbase.apache.org/book.html#build
               </message>
             </requireJavaVersion>
+            <enforceBytecodeVersion>
+              <maxJdkVersion>${compileSource}</maxJdkVersion>
+              <message>HBase has unsupported dependencies.
+  HBase requires that all dependencies be compiled with version ${compileSource} or earlier
+  of the JDK to properly build from source.  You appear to be using a newer dependency. You can use
+  either "mvn -version" or "mvn enforcer:display-info" to verify what version is active.
+              </message>
+            </enforceBytecodeVersion>
           </rules>
         </configuration>
         <executions>
@@ -1221,6 +1236,7 @@
     </hbase-surefire.cygwin-argline>
     <hbase.skip-jacoco>true</hbase.skip-jacoco>
     <jacoco.version>0.6.2.201302030002</jacoco.version>
+    <extra.enforcer.version>1.0-beta-3</extra.enforcer.version>
   </properties>
   <!-- Sorted by groups of dependencies then groupId and artifactId -->
   <dependencyManagement>
-- 
2.3.2 (Apple Git-55)

