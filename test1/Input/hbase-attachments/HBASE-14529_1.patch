From 7a1939d44e510c506ba0d778ec79fa75de8ca012 Mon Sep 17 00:00:00 2001
From: Ashish Singhi <ashish.singhi@huawei.com>
Date: Tue, 13 Oct 2015 18:37:54 +0530
Subject: [PATCH] HBASE-14529 Respond to SIGHUP to reload config

---
 .../apache/hadoop/hbase/regionserver/HRegionServer.java   | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)

diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java
index 6b1573f..2f063c8 100644
--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java
+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java
@@ -52,6 +52,7 @@ import javax.management.MalformedObjectNameException;
 import javax.management.ObjectName;
 import javax.servlet.http.HttpServlet;
 
+import org.apache.commons.lang.SystemUtils;
 import org.apache.commons.lang.math.RandomUtils;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -606,12 +607,14 @@ public class HRegionServer extends HasThread implements
     this.walRoller = new LogRoller(this, this);
     this.choreService = new ChoreService(getServerName().toString());
 
-    Signal.handle(new Signal("HUP"), new SignalHandler() {
-      public void handle(Signal signal) {
-        getConfiguration().reloadConfiguration();
-        configurationManager.notifyAllObservers(getConfiguration());
-      }
-    });
+    if (!SystemUtils.IS_OS_WINDOWS) {
+      Signal.handle(new Signal("HUP"), new SignalHandler() {
+        public void handle(Signal signal) {
+          getConfiguration().reloadConfiguration();
+          configurationManager.notifyAllObservers(getConfiguration());
+        }
+      });
+    }
   }
 
   protected TableDescriptors getFsTableDescriptors() throws IOException {
-- 
1.9.2.msysgit.0

