From 5b776dcfc7e62444a7c8e73bd188da01adff9c71 Mon Sep 17 00:00:00 2001
From: Andrew Purtell <apurtell@apache.org>
Date: Sat, 11 Feb 2017 10:33:33 -0800
Subject: [PATCH] HBASE-17637 Update progress more frequently in
 IntegrationTestBigLinkedList.Generator.persist

---
 .../hadoop/hbase/test/IntegrationTestBigLinkedList.java      | 12 +++++++-----
 1 file changed, 7 insertions(+), 5 deletions(-)

diff --git a/hbase-it/src/test/java/org/apache/hadoop/hbase/test/IntegrationTestBigLinkedList.java b/hbase-it/src/test/java/org/apache/hadoop/hbase/test/IntegrationTestBigLinkedList.java
index 841d7d0..dff1828 100644
--- a/hbase-it/src/test/java/org/apache/hadoop/hbase/test/IntegrationTestBigLinkedList.java
+++ b/hbase-it/src/test/java/org/apache/hadoop/hbase/test/IntegrationTestBigLinkedList.java
@@ -507,6 +507,12 @@ public class IntegrationTestBigLinkedList extends IntegrationTestBase {
       protected void persist(Context output, long count, byte[][] prev, byte[][] current, byte[] id)
           throws IOException {
         for (int i = 0; i < current.length; i++) {
+
+          if (i % 100 == 0) {
+            // Tickle progress every so often else maprunner will think us hung
+            output.progress();
+          }
+
           Put put = new Put(current[i]);
           put.addColumn(FAMILY_NAME, COLUMN_PREV, prev == null ? NO_KEY : prev[i]);
 
@@ -529,12 +535,8 @@ public class IntegrationTestBigLinkedList extends IntegrationTestBase {
             put.addColumn(BIG_FAMILY_NAME, BIG_FAMILY_NAME, this.bigValue);
           }
           mutator.mutate(put);
-
-          if (i % 1000 == 0) {
-            // Tickle progress every so often else maprunner will think us hung
-            output.progress();
-          }
         }
+
         mutator.flush();
       }
 
-- 
2.7.4

