From 837ae3290da20cb966a34ef9f13ce16b5b42bbc7 Mon Sep 17 00:00:00 2001
From: Guangxu Cheng <guangxucheng@gmail.com>
Date: Tue, 23 May 2017 16:41:19 +0800
Subject: [PATCH] HBASE-18094 Display the return value of the command append

---
 hbase-shell/src/main/ruby/hbase/table.rb           |    8 +++++++-
 hbase-shell/src/main/ruby/shell/commands/append.rb |    6 +++++-
 2 files changed, 12 insertions(+), 2 deletions(-)

diff --git a/hbase-shell/src/main/ruby/hbase/table.rb b/hbase-shell/src/main/ruby/hbase/table.rb
index 946c72c..34dbadc 100644
--- a/hbase-shell/src/main/ruby/hbase/table.rb
+++ b/hbase-shell/src/main/ruby/hbase/table.rb
@@ -286,7 +286,13 @@ EOF
         set_op_ttl(append, ttl) if ttl
       end
       append.add(family, qualifier, value.to_s.to_java_bytes)
-      @table.append(append)
+      result = @table.append(append)
+      return nil if result.isEmpty
+
+      # Fetch cell value
+      cell = result.listCells[0]
+      org.apache.hadoop.hbase.util.Bytes::toString(cell.getValueArray,
+          cell.getValueOffset, cell.getValueLength)
     end
 
     #----------------------------------------------------------------------------------------------
diff --git a/hbase-shell/src/main/ruby/shell/commands/append.rb b/hbase-shell/src/main/ruby/shell/commands/append.rb
index 93a4317..2c4ef5b 100644
--- a/hbase-shell/src/main/ruby/shell/commands/append.rb
+++ b/hbase-shell/src/main/ruby/shell/commands/append.rb
@@ -42,7 +42,11 @@ EOF
       end
 
       def append(table, row, column, value, args={})
-        table._append_internal(row, column, value, args)
+        if current_value = table._append_internal(row, column, value, args)
+          puts "CURRENT VALUE = #{current_value}"
+        else
+          puts "No value found at specified coordinates"
+        end
       end
     end
   end
-- 
1.7.1

