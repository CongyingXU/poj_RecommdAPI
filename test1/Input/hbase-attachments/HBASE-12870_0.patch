From 443cc690c64165c5f0187e5c02ad37d422b9c14a Mon Sep 17 00:00:00 2001
From: Chinmay Kulkarni <ckulkarni@salesforce.com>
Date: Wed, 3 May 2017 13:34:56 -0700
Subject: [PATCH] Addendum patch for HBASE-12870. Added check for null pointer.

---
 .../hbase/regionserver/compactions/RatioBasedCompactionPolicy.java   | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/RatioBasedCompactionPolicy.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/RatioBasedCompactionPolicy.java
index ddc07cddd..2ee051b11 100644
--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/RatioBasedCompactionPolicy.java
+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/RatioBasedCompactionPolicy.java
@@ -72,7 +72,10 @@ public class RatioBasedCompactionPolicy extends SortedCompactionPolicy {
         regionInfo = this.toString();
       }
       // Major compaction time has elapsed.
-      long cfTTL = this.storeConfigInfo.getStoreFileTtl();
+      long cfTTL = HConstants.FOREVER;
+      if (this.storeConfigInfo != null) {
+         cfTTL = this.storeConfigInfo.getStoreFileTtl();
+      }
       if (filesToCompact.size() == 1) {
         // Single file
         StoreFile sf = filesToCompact.iterator().next();
-- 
2.11.0 (Apple Git-81)

