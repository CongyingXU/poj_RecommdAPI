From f09f39ad90ab74f5f920ae6a67a92393b7c20e60 Mon Sep 17 00:00:00 2001
From: Ben-Epstein <ben.epstein@wustl.edu>
Date: Tue, 27 Jun 2017 16:08:37 -0500
Subject: [PATCH] created private static pattern matcher for performance

---
 .../java/org/apache/hadoop/hbase/regionserver/StoreFileWriter.java   | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileWriter.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileWriter.java
index 2e3b6f55c7..0d94378d7a 100644
--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileWriter.java
+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileWriter.java
@@ -23,6 +23,7 @@ import com.google.common.base.Preconditions;
 import java.io.IOException;
 import java.net.InetSocketAddress;
 import java.util.UUID;
+import java.util.regex.Pattern;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -55,7 +56,7 @@ import org.apache.hadoop.io.WritableUtils;
 @InterfaceAudience.Private
 public class StoreFileWriter implements CellSink, ShipperListener {
   private static final Log LOG = LogFactory.getLog(StoreFileWriter.class.getName());
-
+  private static final Pattern dash = Pattern.compile("-");
   private final BloomFilterWriter generalBloomFilterWriter;
   private final BloomFilterWriter deleteFamilyBloomFilterWriter;
   private final BloomType bloomType;
@@ -367,7 +368,7 @@ public class StoreFileWriter implements CellSink, ShipperListener {
     if (!fs.getFileStatus(dir).isDirectory()) {
       throw new IOException("Expecting " + dir.toString() + " to be a directory");
     }
-    return new Path(dir, UUID.randomUUID().toString().replaceAll("-", ""));
+    return new Path(dir, dash.matcher(UUID.randomUUID().toString()).replaceAll(""));
   }
 
   @edu.umd.cs.findbugs.annotations.SuppressWarnings(value="ICAST_INTEGER_MULTIPLY_CAST_TO_LONG",
-- 
2.11.0 (Apple Git-81)

