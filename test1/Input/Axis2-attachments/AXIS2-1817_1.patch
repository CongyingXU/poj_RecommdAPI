package calc;

import org.apache.axiom.om.OMAbstractFactory;
import org.apache.axiom.om.OMElement;
import org.apache.axiom.om.OMFactory;
import org.apache.axiom.om.OMNamespace;
import org.apache.axiom.om.OMNode;
import org.apache.axiom.soap.SOAPEnvelope;
import org.apache.axiom.soap.SOAPFactory;
import org.apache.axiom.soap.SOAPHeaderBlock;
import org.apache.axis2.AxisFault;
import org.apache.axis2.Constants;
import org.apache.axis2.wsdl.WSDLConstants;
import org.apache.axis2.addressing.EndpointReference;
import org.apache.axis2.client.OperationClient;
import org.apache.axis2.client.Options;
import org.apache.axis2.client.ServiceClient;
import org.apache.axis2.context.MessageContext;

import javax.xml.namespace.QName;
import javax.xml.stream.FactoryConfigurationError;
import javax.xml.stream.XMLOutputFactory;
import javax.xml.stream.XMLStreamException;
import javax.xml.stream.XMLStreamWriter;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class MyCalcClient {
	
	final static String address = "http://localhost:8080/axis2/services/";
	final static String addService = "AddService";
	final static String substractService = "SubstractService";
	final static String multiplyService = "MultiplyService";
	final static String cService = "CalcService1";
	
	
	public static void main(String[] args){
		
		Options options = new Options();
		EndpointReference ref = new EndpointReference(address+cService);
		options.setTo(ref);
		
		int param1 = 1;
		int param2 = 2;
		String opStr = "add";
		
		Integer pi1 = new Integer(param1);
		Integer pi2 = new Integer(param2);
		
		System.out.println("Invoking...");
		
		try{
			ServiceClient serviceClient = new ServiceClient();
			serviceClient.setOptions(options);
			OMFactory fac = OMAbstractFactory.getOMFactory();
			OMNamespace omNs = fac.createOMNamespace("http://www.cal.com/calc", "calc");
			OMElement payload = fac.createOMElement(opStr, omNs);
			OMElement param1OM = fac.createOMElement("param1", omNs);
			OMElement param2OM = fac.createOMElement("param2", omNs);
			param1OM.setText(Integer.toString(pi1));
			param2OM.setText(Integer.toString(pi2));
			payload.addChild(param1OM);
			payload.addChild(param2OM);			
			serviceClient.setOptions(options);
			OMElement result = serviceClient.sendReceive(payload);
			System.out.println(result.toString());
			
		}catch(AxisFault af){af.printStackTrace();}
		
		
    }

    

  }