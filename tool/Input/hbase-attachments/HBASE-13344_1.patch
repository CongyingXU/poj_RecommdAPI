From 14d6358b0c16d83197ed75369a7bc14c7e43c2e8 Mon Sep 17 00:00:00 2001
From: Matt Warhaftig <mwarhaftig@gmail.com>
Date: Sun, 24 May 2015 18:49:25 -0400
Subject: [PATCH] HBASE-13344 - Add max Java version check for pom
 dependencies.

---
 pom.xml | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

diff --git a/pom.xml b/pom.xml
index 0e95fb0..3e53403 100644
--- a/pom.xml
+++ b/pom.xml
@@ -804,6 +804,13 @@
       <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-enforcer-plugin</artifactId>
+        <dependencies>
+          <dependency>
+            <groupId>org.codehaus.mojo</groupId>
+            <artifactId>extra-enforcer-rules</artifactId>
+            <version>${extra.enforcer.version}</version>
+          </dependency>
+        </dependencies>
         <!-- version set by parent -->
         <configuration>
           <rules>
@@ -827,6 +834,16 @@
   See the reference guide on building for more information: http://hbase.apache.org/book.html#build
               </message>
             </requireJavaVersion>
+            <enforceBytecodeVersion>
+              <maxJdkVersion>${compileSource}</maxJdkVersion>
+              <message>HBase has unsupported dependencies.
+  HBase requires that all dependencies be compiled with version ${compileSource} or earlier
+  of the JDK to properly build from source.  You appear to be using a newer dependency. You can use
+  either "mvn -version" or "mvn enforcer:display-info" to verify what version is active.
+  Non-release builds can temporarily build with a newer JDK version by setting the
+  'compileSource' property (eg. mvn -DcompileSource=1.8 clean package).
+              </message>
+            </enforceBytecodeVersion>
           </rules>
         </configuration>
         <executions>
@@ -1220,6 +1237,7 @@
     </hbase-surefire.cygwin-argline>
     <hbase.skip-jacoco>true</hbase.skip-jacoco>
     <jacoco.version>0.6.2.201302030002</jacoco.version>
+    <extra.enforcer.version>1.0-beta-3</extra.enforcer.version>
   </properties>
   <!-- Sorted by groups of dependencies then groupId and artifactId -->
   <dependencyManagement>
-- 
2.3.2 (Apple Git-55)

